---
layout: ../layouts/DocLayout.astro
title: "Stack Implementation"
description: "The 'Continuum Flow' Engine: A Hybrid Monorepo Architecture"
hero: true
---

## Stack Implementation

This section outlines best-in-class, open-source technologies used for each layer of the Continuum Flow architecture. Each selection is optimized for performance, scalability, and compatibility with modern frameworks like Next.js 15 and React 19.

import StackImplementation from '../components/tables/StackImplementation.astro';

<StackImplementation />

---

### The AI Model Zoo (Execution Layer)

We utilize a Best-in-Class Modular Approach rather than a single provider. This prevents vendor lock-in and allows upgrading specific components (e.g., swapping the Image Generator without breaking the Text Analyzer).

> [!NOTE]
> **Cost Analysis**: A detailed breakdown of the costing layer is available in the [Cost Estimator](/cost-estimator).

import AiModelZoo from '../components/tables/AiModelZoo.astro';

<AiModelZoo />

---

### Advanced Document Management

We treat the screenplay not just as text, but as **executable documentation**.

#### The Quarto (QMD) Pipeline

1.  **Source**: `Chapter_01.md` (Raw Text).
2.  **Processing**: The Agent converts this into `Script_01.qmd` (Quarto Markdown).
3.  **Metadata Injection**: The Agent embeds JSON metadata (Camera angles, Lighting) inside YAML headers or hidden code blocks within the QMD.
4.  **Render**:
    *   **For Humans**: Quarto renders a clean PDF looking like a Hollywood script (Courier font, proper indentation).
    *   **For Robots**: The system parses the underlying JSON data blocks from the same file to drive the video generator.

> [!TIP]
> **Single Source of Truth**: The readable PDF script reviewed by humans is the exact same code that generates the video.

---

### Audio & Lip Sync Architecture

Professional production requires **Decoupling**. We generally avoid "all-in-one" generators to maintain granular control over performance.

*   **Step 1: Audio Production (The Radio Play)**
    *   Generate full audio track using ElevenLabs.
    *   **Forced Alignment**: Use tools like Gentle or OpenAI Whisper to get exact timing of every word.
*   **Step 2: Video Generation (The Silent Film)**
    *   Generate the 8-second video visuals based on the visual prompt.
*   **Step 3: The Sync Pass (Post-Process)**
    *   **Lip-Sync**: Run Video + Audio through a dedicated Sync engine (Wav2Lip/SyncLabs).

---

### 5. Asset Management: "The Cloud-Local Mirror"

Team collaboration on 50GB+ video projects is challenging. We solve this with a "Split-Brain" storage strategy.

#### Storage Strategy

*   **Code & Scripts**: `GitHub` (.md, .qmd, .json) - Version controlled, lightweight.
*   **Heavy Assets**: `AWS S3 / Cloudflare R2` (.mp4, .png, .wav) - Cheap object storage.

#### The Sync Mechanism (`npm run asset:sync`)

1.  Cloud Worker renders video -> Uploads to S3 -> Pushes Manifest to Database.
2.  Local CLI detects new manifest.
3.  **Node.js `fs`** generates folder structure locally matching the Chapter/Scene hierarchy.
4.  Pulls only the new video files to your local folder.

---

### 6. Execution Environment

import ExecutionEnvironment from '../components/tables/ExecutionEnvironment.astro';

<ExecutionEnvironment />
