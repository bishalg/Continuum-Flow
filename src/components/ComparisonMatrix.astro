---
// Comparison Matrix Component
---

<div class="comparison-matrix-container my-8 sm:my-16 not-prose font-sans">
  <div class="max-w-6xl mx-auto space-y-8 sm:space-y-12 px-4 sm:px-6 lg:px-0">
    <!-- Header -->
    <header class="text-center">
      <h2
        class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-black text-slate-800 dark:text-white mb-3 sm:mb-4 uppercase tracking-tight"
      >
        Context Architecture
      </h2>
      <p class="text-slate-500 dark:text-slate-400 text-lg">
        Standard RAG Approaches vs. The Continuum Flow Methodology
      </p>
    </header>

    <!-- TOP SECTION: VISUAL PROFILE (Radar Chart) -->
    <section
      class="bg-white dark:bg-slate-900 rounded-2xl sm:rounded-3xl shadow-xl sm:shadow-2xl border border-slate-200 dark:border-white/10 p-4 sm:p-8 lg:p-12 overflow-hidden relative"
    >
      <div
        class="absolute top-0 right-0 w-64 h-64 bg-teal-500/5 blur-[100px] rounded-full -mr-32 -mt-32"
      >
      </div>

      <div
        class="grid grid-cols-1 gap-8 lg:grid-cols-2 lg:gap-12 items-center relative z-10"
      >
        <div class="order-2 lg:order-1">
          <h3
            class="text-xl sm:text-2xl font-bold text-slate-800 dark:text-white mb-4 sm:mb-6"
          >
            Architecture Profile
          </h3>
          <p
            class="text-sm sm:text-base text-slate-600 dark:text-slate-400 mb-6 sm:mb-8 leading-relaxed"
          >
            While standard Context Management treats data spatially (finding
            "nearby" vectors),
            <strong class="text-teal-600 dark:text-teal-400">Continuum Flow</strong> treats
            data chronologically and structurally. This results in a massive shift
            towards explicit state management and temporal awareness.
          </p>
          <div class="flex flex-col gap-4">
            <div
              class="flex items-center gap-4 bg-slate-50 dark:bg-white/5 p-3 rounded-xl border border-slate-100 dark:border-white/5"
            >
              <span
                class="w-4 h-4 rounded-full bg-slate-400 shadow-lg shadow-slate-400/20"
              ></span>
              <span
                class="text-sm font-black text-slate-600 dark:text-slate-400 uppercase tracking-widest"
                >Standard Code RAG</span
              >
            </div>
            <div
              class="flex items-center gap-4 bg-teal-50 dark:bg-teal-900/10 p-3 rounded-xl border border-teal-100 dark:border-teal-900/20"
            >
              <span
                class="w-4 h-4 rounded-full bg-teal-600 shadow-lg shadow-teal-600/20"
              ></span>
              <span
                class="text-sm font-black text-teal-700 dark:text-teal-400 uppercase tracking-widest"
                >Continuum Flow</span
              >
            </div>
          </div>
        </div>

        <div class="order-1 lg:order-2 flex justify-center">
          <div
            class="chart-wrapper h-[280px] sm:h-[350px] lg:h-[400px] w-full max-w-full lg:max-w-[500px] relative"
          >
            <canvas id="comparisonRadar"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- BOTTOM SECTION: FEATURE MATRIX -->
    <section
      class="bg-white dark:bg-slate-900 rounded-2xl sm:rounded-3xl shadow-xl sm:shadow-2xl overflow-hidden border border-slate-200 dark:border-white/10 mt-8 sm:mt-12"
    >
      <div
        class="bg-slate-50 dark:bg-white/5 border-b border-slate-200 dark:border-white/10 p-4 sm:p-6 hidden md:grid md:grid-cols-[1fr_1.5fr_1.5fr] gap-4 sm:gap-8"
      >
        <div
          class="font-black text-slate-400 text-[10px] uppercase tracking-[0.2em]"
        >
          Feature Dimension
        </div>
        <div
          class="font-black text-slate-500 dark:text-slate-400 text-xs uppercase tracking-widest"
        >
          Standard / RAG Approach
        </div>
        <div
          class="font-black text-teal-600 dark:text-teal-400 text-xs uppercase tracking-widest"
        >
          Continuum Flow Architecture
        </div>
      </div>

      <!-- Matrix Rows -->
      <div class="matrix-rows">
        {
          [
            "Primary Mechanism",
            "Temporal Awareness",
            "Context Retention",
            "State Management",
            "Summarization Strategy",
            "Handling Overflows",
          ].map((feature, idx) => {
            const data = [
              {
                std: "RAG & Sliding Window",
                snp: "Hierarchical Summarization",
                stdDesc:
                  "Indexes vectors; retrieves based on similarity match.",
                snpDesc:
                  "Maintains a recursive tree of narrative summaries (Level 1-3).",
              },
              {
                std: "Low (Spatial)",
                snp: "High (Chronological)",
                stdDesc:
                  "Treats code/text as a dependency graph or proximity vector.",
                snpDesc:
                  "Treats text as a causal sequence (Cause -> Effect -> Outcome).",
              },
              {
                std: "Reactive",
                snp: "Proactive",
                stdDesc: "Retrieves data only after a user query is made.",
                snpDesc:
                  'Pre-computes context ("Backbone") before processing chunks.',
              },
              {
                std: "Implicit",
                snp: "Explicit DB",
                stdDesc: "Relies on raw file content and git history diffs.",
                snpDesc:
                  'Uses JSON "Character Sheets" & "Inventory" as state databases.',
              },
              {
                std: "Compaction",
                snp: "Narrative Synthesis",
                stdDesc: "Compresses history primarily to fit token limits.",
                snpDesc:
                  "Rewrites beats into higher-level abstractions preserving meaning.",
              },
              {
                std: "Truncation",
                snp: "Critical Locking",
                stdDesc: "Drops oldest turns or summarizes purely by count.",
                snpDesc:
                  'Drops non-essentials while "Locking" critical plot points.',
              },
            ][idx];

            return (
              <div class="feature-row grid grid-cols-1 md:grid-cols-[1fr_1.5fr_1.5fr] items-start md:items-center gap-3 sm:gap-4 md:gap-8 p-4 sm:p-6 border-b border-slate-100 dark:border-white/5 last:border-0 hover:bg-slate-50/50 dark:hover:bg-white/5 transition-colors">
                <div class="feature-label font-black text-slate-800 dark:text-white text-[10px] uppercase tracking-widest border-l-2 border-teal-500 pl-3 md:border-0 md:pl-0">
                  {feature}
                </div>
                <div class="standard-col text-sm text-slate-500 dark:text-slate-400 pl-4 md:pl-0">
                  <strong class="text-slate-700 dark:text-slate-300 block mb-1">
                    {data.std}
                  </strong>
                  <p class="text-xs leading-relaxed">{data.stdDesc}</p>
                </div>
                <div class="continuum-col bg-teal-50/50 dark:bg-teal-900/10 p-3 sm:p-5 rounded-xl sm:rounded-2xl border-l-4 border-teal-500 shadow-sm">
                  <strong class="text-teal-700 dark:text-teal-400 block mb-1">
                    Continuum Flow
                  </strong>
                  <p class="text-xs text-teal-800 dark:text-teal-500/80 leading-relaxed">
                    {data.snpDesc}
                  </p>
                </div>
              </div>
            );
          })
        }
      </div>
    </section>

    <footer
      class="text-center text-slate-400 dark:text-slate-600 text-[9px] sm:text-[10px] font-black uppercase tracking-widest py-8 sm:py-12"
    >
      Generated for Continuum Flow Architectural Documentation v1.0
    </footer>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js" is:inline></script>
<script is:inline>
  (function () {
    if (typeof Chart === "undefined") return;

    const ctx = document.getElementById("comparisonRadar")?.getContext("2d");
    if (!ctx) return;

    const getThemeColors = () => {
      const isDark = document.documentElement.classList.contains("dark");
      return {
        grid: isDark ? "rgba(255, 255, 255, 0.1)" : "rgba(0, 0, 0, 0.1)",
        angle: isDark ? "rgba(255, 255, 255, 0.1)" : "rgba(0, 0, 0, 0.1)",
        labels: isDark ? "#94A3B8" : "#64748B", // slate-400 : slate-500
      };
    };

    const colors = getThemeColors();

    const chart = new Chart(ctx, {
      type: "radar",
      data: {
        labels: [
          "Temporal Awareness",
          "Proactive Computing",
          "Explicit State",
          "Narrative Cohesion",
          "Token Efficiency",
        ],
        datasets: [
          {
            label: "Standard RAG",
            data: [3, 2, 4, 5, 6],
            fill: true,
            backgroundColor: "rgba(148, 163, 184, 0.2)",
            borderColor: "#94A3B8",
            pointBackgroundColor: "#94A3B8",
            pointBorderColor: "#fff",
            pointRadius: 4,
          },
          {
            label: "Continuum Flow Architecture",
            data: [9, 10, 9, 10, 8],
            fill: true,
            backgroundColor: "rgba(15, 118, 110, 0.2)",
            borderColor: "#0F766E",
            pointBackgroundColor: "#0F766E",
            pointBorderColor: "#fff",
            pointRadius: 4,
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          r: {
            angleLines: { color: colors.angle },
            grid: { color: colors.grid },
            pointLabels: {
              font: {
                size: 10,
                family: "'Inter', sans-serif",
                weight: "900",
              },
              color: colors.labels,
            },
            ticks: { display: false, max: 10 },
          },
        },
        plugins: {
          legend: {
            position: "bottom",
            labels: {
              font: {
                family: "'Inter', sans-serif",
                weight: "bold",
                size: 11,
              },
              color: colors.labels,
              padding: 20,
              usePointStyle: true,
            },
          },
          tooltip: {
            enabled: true,
            backgroundColor: "rgba(15, 23, 42, 0.9)",
            titleFont: { family: "'Inter', sans-serif", size: 13 },
            bodyFont: { family: "'Inter', sans-serif", size: 12 },
            padding: 10,
            cornerRadius: 8,
            displayColors: true,
          },
        },
      },
    });

    // Watch for theme changes
    const observer = new MutationObserver((mutations) => {
      mutations.forEach((mutation) => {
        if (
          mutation.type === "attributes" &&
          mutation.attributeName === "class"
        ) {
          const newColors = getThemeColors();

          // Update scales
          chart.options.scales.r.grid.color = newColors.grid;
          chart.options.scales.r.angleLines.color = newColors.angle;
          chart.options.scales.r.pointLabels.color = newColors.labels;

          // Update legend
          chart.options.plugins.legend.labels.color = newColors.labels;

          chart.update();
        }
      });
    });

    observer.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ["class"],
    });
  })();
</script>
